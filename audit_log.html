<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" type="text/css" href="/api/css/bootstrap.min.css">
    <link rel="stylesheet2" type="text/css" href="/api/css/dataTables.bootstrap4.min.css">

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script type="text/javascript" src="/api/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="/api/js/dataTables.bootstrap4.min.js"></script>

    <title>Search Results</title>
  </head>
  <body>
    <nav class="navbar navbar-expand-sm navbar-light bg-light border-bottom border-dark">
      <a href="/"><img src="api/images/home.png"></a> <!-- Home by Anang Taufik from the Noun Project -->
      <div class="navbar-collapse collapse justify-content-stretch" id="navbar5">
        <div class="w-100 text-center h1 font-weight-bold">
          AUDIT LOG
        </div>
      </div>
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <select class="custom-select rounded-0" id="chooseUserHeader">
            <option disabled selected value="-1">Select User</option>
          </select>
        </li>
      </ul>
  </nav>
  <div style="width:95%; margin: 0 auto">
    <!-- EXAMPLE DATA - REPLACE WITH DATABASE DATA -->
    <table id="example" class="table table-striped table-bordered">
        <thead>
            <tr>
                <th>DATE</th>
                <th>USER</th>
                <th>ACTION</th>
                <th>TYPE</th>
                <th>TARGET</th>
                <th>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</th>
            </tr>
        </thead>
        <tbody>
          <tr>
              <td>10-20-2020</td>
              <td>ALEXANDER ACARA</td>
              <td>EDITED</td>
              <td>BATCH RECORD</td>
              <td>#123</td>
              <td></td>
          </tr>
          <tr>
              <td>10-20-2020</td>
              <td>ALEXANDER ACARA</td>
              <td>EDITED</td>
              <td>MANUFACTURING WORKSHEET</td>
              <td>#85</td>
              <td></td>
          </tr>
          <tr>
              <td>10-20-2020</td>
              <td>ALEXANDER ACARA</td>
              <td>DELETED</td>
              <td>BATCH RECORD</td>
              <td>#526</td>
              <td></td>
          </tr>
          <tr>
              <td>10-20-2020</td>
              <td>ALEXANDER ACARA</td>
              <td>EDITED</td>
              <td>BATCH RECORD</td>
              <td>#8452</td>
              <td></td>
          </tr>
          <tr>
              <td>10-20-2020</td>
              <td>ALEXANDER ACARA</td>
              <td>CREATED</td>
              <td>BATCH RECORD</td>
              <td>#65584</td>
              <td></td>
          </tr>
        </tbody>
    </table>
  </div>
    <script>
      $(document).ready(function() {
      console.log(document.cookie);

      if (document.cookie.includes("user")){
        var user = document.cookie.split("user=")[1].split(";")[0];
        $("#chooseUser").val(user);
        $("#chooseUserHeader").val(user);
      }
    });

    $(document).on('change', '#chooseUser', function (){
      document.cookie="user=" + $("#chooseUser").val() + "; samesite=strict; path=/";
      $("#chooseUserHeader").val($("#chooseUser").val());
    });

    $(document).on('change', '#chooseUserHeader', function (){
      document.cookie="user=" + $("#chooseUserHeader").val() + "; samesite=strict; path=/";
      $("#chooseUser").val($("#chooseUserHeader").val());
    });
      
      $(document).ready(function() {
        $('#example').DataTable({
          "order": [[1, "desc"]],
          stateSave: true
        });
      });

      // Function borrowed from https://stackoverflow.com/questions/901115/how-can-i-get-query-string-values-in-javascript
      function getParameterByName(name, url = window.location.href) {
        name = name.replace(/[\[\]]/g, '\\$&');
        var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, ' '));
      }
    </script>

  </body>
</html>
